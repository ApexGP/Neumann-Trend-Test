# 常见问题解答 (FAQ)

本文档收集了用户在使用诺依曼趋势测试工具时遇到的常见问题和解决方案。

## 📋 目录

- [安装和配置](#安装和配置)
- [数据输入和格式](#数据输入和格式)
- [测试结果解读](#测试结果解读)
- [性能和优化](#性能和优化)
- [Web 界面问题](#web-界面问题)
- [技术问题](#技术问题)

## 安装和配置

### Q: 如何安装诺依曼趋势测试工具？

**A:** 有两种方式：

1. **下载预编译版本（推荐）**

   - 访问 [Releases 页面](https://github.com/Xyf0606/Neumann-Trend-Test/releases)
   - 下载适合你系统的压缩包
   - 解压后运行 `start.bat`（Windows）或 `./start.sh`（Linux/macOS）

2. **从源码构建**
   - 参考 [构建指南](BUILD.md)
   - 确保安装了所需的依赖项

### Q: 程序启动后显示乱码或英文，如何设置中文界面？

**A:**

1. 启动程序后，在主菜单选择"设置"
2. 选择"语言设置"
3. 选择"中文 (Chinese)"
4. 设置会自动保存，重启后生效

### Q: 配置文件保存失败，提示权限错误？

**A:** v2.2.1 版本引入了智能配置管理：

- 用户配置保存在 `data/usr/config_private.json`
- 如果无权限，程序会自动降级到只读模式
- 确保对程序目录有写入权限，或以管理员身份运行

### Q: 如何自定义置信度水平？

**A:**

1. 主菜单 → 设置 → 置信度设置 → 自定义
2. 准备包含标准值的 JSON 或 CSV 文件
3. 文件格式示例：
   ```json
   {
     "4": 0.123,
     "5": 0.156,
     ...
   }
   ```
4. 导入成功后即可在测试中使用

## 数据输入和格式

### Q: 支持哪些数据文件格式？

**A:** 目前支持：

- **CSV 文件**：完全支持，推荐格式
- **Excel 文件**：✅ 完整支持 .xlsx 格式，⚠️ .xls 格式建议转换为 .xlsx
- **手动输入**：直接在程序中输入数据

### Q: CSV 文件应该如何格式化？

**A:** 推荐格式：

```csv
时间,数值
0,99.95
1,99.88
2,99.82
3,99.76
```

**注意事项：**

- 第一行可以是表头（程序会自动检测）
- 时间列可选，程序会自动生成递增序列
- 数值必须是数字格式
- 支持逗号和分号作为分隔符

### Q: Excel 文件应该如何准备？

**A:**

**支持的格式：**

- ✅ `.xlsx` 格式：完全支持，推荐使用
- ⚠️ `.xls` 格式：不支持，请另存为 .xlsx 格式
- ✅ `.csv` 格式：完全支持，兼容性最佳

**Excel 文件要求：**

- 数据应存放在工作表的前两列（时间、数值）
- 第一行可以是表头（程序会自动检测）
- 数值必须是数字格式，避免文本格式的数字
- 支持多工作表文件，程序会自动检测或让您选择

**示例 Excel 结构：**

```
A列（时间）    B列（数值）
时间          药物含量
0             100.00
3             99.85
6             99.72
9             99.58
```

### Q: Excel 文件导入失败怎么办？

**A:** v2.9.0 版本大幅改进了 Excel 支持：

**常见解决方案：**

1. **确认文件格式**：使用 .xlsx 格式而不是 .xls
2. **检查数据格式**：确保数值列为数字格式
3. **尝试 CSV 转换**：在 Excel 中另存为 CSV 格式
4. **查看错误信息**：程序会提供具体的错误原因和建议

**支持的 Excel 特性：**

- ✅ 多工作表文件
- ✅ 共享字符串表
- ✅ 自动列类型识别
- ✅ 数据预览功能
- ✅ 智能错误恢复

### Q: 如何处理包含多个工作表的 Excel 文件？

**A:** v2.9.0 版本支持多工作表处理：

1. **自动检测**：程序会自动使用第一个工作表
2. **手动选择**：如需指定工作表，程序会显示可选列表
3. **工作表命名**：建议使用有意义的工作表名称

### Q: 需要多少个数据点才能进行测试？

**A:**

- **最少**：4 个数据点（统计学最低要求）
- **最多**：60 个数据点（基于标准值表覆盖范围）
- **推荐**：10-30 个数据点，结果更稳定

### Q: 时间点必须是连续的吗？

**A:**

- 不必须连续，但建议保持合理间隔
- 程序支持不等间隔的时间序列
- 如果没有时间列，程序会自动生成 0, 1, 2, ... 序列

## 测试结果解读

### Q: 如何判断是否存在趋势？

**A:** 诺依曼趋势测试的判断标准：

- **PG 值 ≤ W(P) 阈值** → 存在显著趋势
- **PG 值 > W(P) 阈值** → 无显著趋势

程序会自动计算并显示结果，包括：

- 每个测试点的 PG 值和阈值
- 整体趋势判断
- 统计汇总信息

### Q: 什么是 PG 值？

**A:** PG 值是诺依曼趋势测试的统计量：

- 计算公式基于相邻数据点的平方差
- 数值越小，表示趋势越显著
- 与置信度相关的 W(P) 阈值进行比较

### Q: "整体趋势"和单个测试点的结果不一致？

**A:** v2.2.0 版本优化了趋势判断算法：

- **单个测试点**：基于该点的 PG 值判断
- **整体趋势**：使用智能趋势检测算法，更适合药物稳定性测试
- 整体判断会考虑连续趋势点的分布

### Q: 如何保存和导出测试结果？

**A:** 多种方式：

1. **程序内保存**：测试完成后选择保存数据集
2. **结果导出**：
   - ASCII 表格（终端显示）
   - SVG 图表（高质量矢量图）
   - CSV 格式（便于 Excel 分析）
3. **批量处理报告**：HTML 或 CSV 格式

## 性能和优化

### Q: 处理大数据集时程序很慢？

**A:** 优化建议：

1. **使用批量处理模式**：主菜单 → 批量数据处理
2. **调整数据点限制**：设置 → 高级选项
3. **使用 Release 版本**：性能比 Debug 版本快 3-5 倍
4. **命令行模式**：`neumann -f data.csv` 直接处理

### Q: 如何批量处理多个文件？

**A:**

1. 主菜单 → 批量数据处理
2. 选择"处理目录中的所有数据文件"
3. 输入包含 CSV 文件的目录路径
4. 程序会自动扫描并处理所有支持的文件
5. 可导出汇总报告

### Q: 内存占用过高？

**A:**

- 程序使用流式处理，正常内存占用很低
- 如果问题持续，检查数据文件是否过大
- 考虑分批处理或联系技术支持

## Web 界面问题

### Q: 如何启动 Web 界面？

**A:** v2.2.0 统一了启动方式：

1. 运行 `start.bat` 或 `./start.sh`
2. 在主菜单选择"启动 Web 服务器"
3. 浏览器访问显示的 URL（默认 http://localhost:8080）

### Q: Web 界面无法访问？

**A:** 检查步骤：

1. **端口占用**：`netstat -an | grep 8080`
2. **防火墙设置**：确保端口 8080 开放
3. **更换端口**：在设置中修改端口号
4. **浏览器兼容性**：使用现代浏览器（Chrome、Firefox、Edge）

### Q: Web 服务器如何停止？

**A:**

- 在 CLI 界面再次选择"启动 Web 服务器"
- 选择"停止 Web 服务器"
- 或者关闭 CLI 程序

### Q: Web 界面功能比 CLI 少？

**A:**

- Web 界面提供基本的测试功能
- 高级功能（批量处理、可视化）建议使用 CLI
- 未来版本会逐步完善 Web 功能

### Q: Web 服务器启动信息显示的语言如何设置？

**A:** v2.7.1+ 完善了 Web 服务器的国际化支持：

- **跟随配置文件**：Web 服务器启动信息会根据 `config.json` 中的语言设置显示
- **修改语言**：在 CLI 中进入"设置" → "语言设置"，或直接编辑配置文件
- **支持内容**：包括启动信息、错误提示、帮助文档等
- **实时切换**：修改配置后重启服务器即可生效

## 技术问题

### Q: 支持哪些操作系统？

**A:**

- **Windows**: 10/11，支持 MinGW 和 MSVC 编译
- **Linux**: Ubuntu 18.04+, CentOS 7+, Arch Linux
- **macOS**: 10.15+ (Catalina)

### Q: 如何更新到最新版本？

**A:**

1. 备份当前配置文件（`data/usr/`）
2. 下载最新版本
3. 解压覆盖原文件
4. 启动程序，配置会自动迁移

### Q: 程序崩溃或报错怎么办？

**A:**

1. **记录错误信息**：包括错误消息和操作步骤
2. **检查数据格式**：确保输入数据符合要求
3. **重启程序**：有时可以解决临时问题
4. **提交 Issue**：[GitHub Issues](https://github.com/Xyf0606/Neumann-Trend-Test/issues)

### Q: 如何查看程序版本？

**A:**

- CLI：`neumann --version`
- 程序内：主菜单 → 关于
- README 和 CHANGELOG 中也有版本信息

**当前最新版本：v2.9.0**

- ✅ 完整的 Excel 文件支持
- ✅ 增强的用户体验
- ✅ 现代化的技术架构

### Q: Excel 文件中的中文显示有问题？

**A:** v2.9.0 版本改进了字符编码处理：

- **Excel 导入**：正确处理 Excel 中的中文内容
- **CSV 导出**：添加 UTF-8 BOM，确保 Excel 正确显示中文
- **跨平台**：在 Windows、Linux、macOS 上都能正确处理中文

### Q: 大型 Excel 文件处理慢怎么办？

**A:** v2.9.0 版本优化了性能：

1. **文件大小建议**：

   - 小于 10MB：直接处理
   - 10MB-50MB：可能需要等待几秒
   - 大于 50MB：建议转换为 CSV 格式

2. **性能优化技巧**：

   - 删除不必要的工作表
   - 清理空行和空列
   - 使用 CSV 格式获得最佳性能

3. **替代方案**：
   - 使用批量处理模式
   - 分批导入大型数据集

### Q: 自定义置信度导入失败？

**A:** v2.2.1 版本修复了相关问题：

- 确保文件格式正确（JSON 或 CSV）
- 检查样本数范围（4-60）
- 验证 W(P) 值的合理性
- 查看详细错误信息

### Q: 彩色输出显示异常？

**A:**

- Windows：确保使用 Windows 10+ 的现代终端
- 或在设置中关闭彩色输出：`"enableColorOutput": false`
- Linux/macOS：检查终端的 ANSI 颜色支持

### Q: 标准值文件丢失？

**A:** v2.2.1 的智能文件管理：

- 程序会自动从 `ref/` 复制到用户目录
- 如果文件损坏，程序会使用内置默认值
- 用户可以从示例目录重新导入

## 使用技巧

### 💡 提高效率的技巧

1. **使用快捷键**：大多数菜单支持数字选择
2. **批量处理**：一次处理整个目录的文件
3. **保存常用数据集**：避免重复输入
4. **配置持久化**：一次设置，永久生效
5. **命令行模式**：自动化脚本中使用

### 💡 数据分析建议

1. **多置信度对比**：使用 95%、99% 对比结果
2. **趋势可视化**：查看 PG 值折线图
3. **分段分析**：大数据集可分段测试
4. **结果验证**：与其他统计方法对比

---

## 仍有问题？

如果 FAQ 没有解决您的问题：

1. **搜索已有 Issues**：[GitHub Issues](https://github.com/Xyf0606/Neumann-Trend-Test/issues)
2. **提交新问题**：提供详细信息和复现步骤
3. **功能建议**：[GitHub Discussions](https://github.com/Xyf0606/Neumann-Trend-Test/discussions)

感谢使用诺依曼趋势测试工具！
